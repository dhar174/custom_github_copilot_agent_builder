"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.buildPrBody = buildPrBody;
function buildPrBody(result, manifest, context) {
    const header = `## AgentOps Pack: ${manifest.name} v${manifest.version}`;
    const totalChanged = result.summary.added + result.summary.updated;
    const stats = `
### Summary
- **Files Changed**: ${totalChanged}
- **Added**: ${result.summary.added}
- **Updated**: ${result.summary.updated}
- **Skipped**: ${result.summary.skipped}
- **Warnings**: ${result.warnings.length}
`;
    const files = result.changes.filter(f => f.status !== 'skipped' && f.status !== 'unchanged');
    // Sort files for stability
    files.sort((a, b) => a.path.localeCompare(b.path));
    const maxFiles = 50;
    let fileList = '_No file changes_';
    if (files.length > 0) {
        const items = files.slice(0, maxFiles).map(f => `- [${f.status.toUpperCase()}] ${f.path}`);
        if (files.length > maxFiles) {
            items.push(`... and ${files.length - maxFiles} more`);
        }
        fileList = `### Files Changed\n${items.join('\n')}`;
    }
    const warningsSection = result.warnings.length > 0
        ? `### Warnings\n${result.warnings.map(w => `- ${w}`).join('\n')}\n`
        : '';
    const checklist = `
### Review Checklist
- [ ] **Schema Check**: Verified config matches expectations
- [ ] **Lint**: Generated code passes linting
- [ ] **Manual Review**: Checked managed sections for correctness
`;
    const footer = `
---
*Generated by AgentOps Pack Applier*
Run ID: ${context.runId}
`;
    return [header, stats, fileList, warningsSection, checklist, footer].join('\n');
}
